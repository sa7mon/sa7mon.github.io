<!doctype html><html lang=en-us dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width"><title>Change Network Location in Windows 8.1/2012 R2 from Powershell | Dan [the] Salmon</title><link rel=alternate type=application/rss+xml title="Dan [the] Salmon: Posts" href=/posts/index.xml><link rel=alternate type=application/rss+xml title="Dan [the] Salmon: Links" href=/links/index.xml><link rel=me href=https://infosec.exchange/@dan name=Mastodon><link rel=me href=https://github.com/sa7mon name=GitHub><link rel=stylesheet href=/combined.min.a5fe1913713a5e577355cad1fe1240b37249c2f949298b40b20c33e509bdae1e.css integrity="sha256-pf4ZE3E6XldzVcrR/hJAs3JJwvlJKYtAsgwz5Qm9rh4=" crossorigin=anonymous></head><body><header><div class=header-container><a class=brand href=/>Dan [the] Salmon</a><nav><ul><li><a href=/about/>About</a></li><li><a href=/posts/>Posts</a></li><li><a href=/links/>Links</a></li><li><a href=/contact/>Contact</a></li></ul></nav></div></header><main class=page><time class=pub-date datetime=2017-08-26T20:46:25+00:00>August 26, 2017</time><h1 class=title>Change Network Location in Windows 8.1/2012 R2 from Powershell</h1><div class=tags><a href=/tags/windows/>Windows</a></div><h1 id=step-1>Step 1</h1><p>From an elevated PowerShell window issue the following command to gather some information about our current network profile:</p><pre class="command-line language-powershell" data-output=2-8 data-prompt="C:\>">
<code class=language-powershell>Get-NetConnectionProfile

Name             : Unidentified Network
InterfaceAlias   : Ethernet
InterfaceIndex   : 10
NetworkCategory  : Public
IPv4Connectivity : LocalNetwork
IPv6Connectivity : LocalNetwork</code>
</pre><p>The only information we really need from this output is the “InterfaceIndex”</p><h1 id=step-2>Step 2</h1><p>After getting the InterfaceIndex, we run the following command:</p><pre class="command-line language-powershell" data-output=2-8 data-prompt="C:\>">
<code class=language-powershell>Set-NetConnectionProfile -InterfaceIndex 10 -NetworkCategory Private</code>
</pre><p>The last argument is what category you want to switch it to. The only allowed values here are “Public” or “Private” as per the <a href=https://technet.microsoft.com/en-us/library/jj899565.aspx>MSDN documentation</a>. The category can also be “DomainAuthenticated” but Windows will automatically assign this when the machine is added to a domain.</p></main></body></html>